<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.crawler">

	<resultMap type="restInfoDTO" id="restInfoResult">	
		<result property="urlNO" column="urlNO" />	
		<result property="name" column="name" />
		<result property="url" column="url" />
	</resultMap>
	
	<resultMap type="boardDTO" id="boardResult">	
		<result property="articleIdx" column="articleIdx" />	
		<result property="hotplaceIdx" column="hotplaceIdx" />
		<result property="contents" column="contents" />
		<result property="username" column="username" />
		<result property="userTotalReview" column="userTotalReview" />
		<result property="restIdx" column="restIdx" />
		<result property="regDate" column="regDate" />
		<result property="reviewStamp" column="reviewStamp" />
		<result property="mainImage" column="mainImage" />
		<result property="subImage1" column="subImage1" />
		<result property="subImage2" column="subImage2" />
		<result property="subImage3" column="subImage3" />
		<result property="defaultImage" column="defaultImage" />
	</resultMap>
	
	<select id="selectAllRestURL" resultMap="restInfoResult">
		<![CDATA[
			SELECT * FROM URL_INFO order by urlno
		]]>	
	</select>

	<insert id="insertRestInfo" parameterType="RestInfoDTO">
		<![CDATA[
			INSERT INTO RESTAURANT_INFO
			(RESTIDX, RESTNAME, RESTADDRESS, RESTJIBUNADDRESS, RESTPHONE, RESTMENU, 
			RESTPRICE, RESTPARK, RESTOPEN, RESTMENULIST, RESTTAG)
			VALUES(#{restIdx}, #{restName}, #{restAddress}, #{restJibunAddress}, #{restPhone},
				   #{restMenu}, #{restPrice}, #{restPark}, #{restOpen}, #{restMenuList}, #{restTag})
		]]>
	</insert>
	
	<!--  리뷰 매장 idx 수정 --> 
	<select id="selectReviews" resultMap="boardResult" parameterType="String">
		<![CDATA[
			SELECT articleIdx FROM REVIEW_BOARD WHERE resturl = #{resIdxURL} 
		]]>	
	</select>
	
	<insert id="modReviewIdx" parameterType="java.util.Map">
		<![CDATA[
			UPDATE REVIEW_BOARD SET restaurantIdx = #{RestaurantIdx} WHERE ARTICLEIDX = #{ReviewIdx}
		]]>
	</insert>
	
	<!-- 리뷰 이미지 다운 -->
	<select id="selectAllReview" resultMap="boardResult">
		<![CDATA[
			SELECT * FROM REVIEW_BOARD order by articleIdx 
		]]>	
	</select>
	
	<insert id="addImageInfo" parameterType="java.util.Map">
		<![CDATA[
			INSERT INTO IMAGE_INFO
			(IMAGEFILENO, IMAGEFILENAME, ARTICLEIDX, RESTAURANTIDX)
			VALUES(#{imageFileNO}, #{imageFileName}, #{articleIdx}, #{restaurantIdx})
		]]>
	</insert>
</mapper>